<!DOCTYPE html>
<html>

<head>
    <title>YouTube Downloader</title>
    <meta charset="utf-8" />
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <style type="text/css">
        #banner {
            height: 100vh;
            background-image: linear-gradient(to right, white 20%, black 100%), url('./static/bg-image.jpg');
            background-blend-mode: color-dodge;
        }

        #banner .container-fluid .jumbotron {
            background: transparent;
        }
    </style>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"
        integrity="sha384-/KNQL8Nu5gCHLqwqfQjA689Hhoqgi2S84SNUxC3roTe4EhJ9AfLkp8QiQcU8AMzI"
        crossorigin="anonymous"></script>
</head>

<body>
    <div id="banner">
        <div class="container-fluid">
            <div class="jumbotron text-center">
                <h3>Vedic YouTube Audio Downloader</h3>
            </div>
            <div class="row">
                <div class="col-md-4 offset-md-4">
                    <!-- <form class = "downloadForm"> -->
                    <div class="form-group">
                        <input class="form-control" type="text" name="url" placeholder="Youtube Url" required />
                    </div>
                    <div class="form-group text-center">
                        <!-- <input id="submitBtn" class="btn btn-primary" type="submit" onclick="download(event);" value="Download" /> -->
                        <input id="submitBtn" class="btn btn-primary" type="submit" value="Download" />
                        <p id="progress">0%</p>
                    </div>
                    <!-- </form> -->
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        const progressEl = document.getElementById("progress");
        // progressEl.style.display = "none";

        const socket = io();
        let socketid = "";

        socket.on("connect", () => {
            socketid = socket.id
        });
        socket.on("progress", (downloaded) => {
            progressEl.innerHTML = downloaded + "%";
        });

        $('#submitBtn').click((e) => {
            e.preventDefault();
            let url = $(".form-group .form-control").val();
            console.log("valueee:   =>>>>>>>>>>>>>>>>>>   ", url);

            // if (url === "") {
            //     alert("Please Enter a url first!");
            // }
            // else {
                // progressEl.style.display = "block";

                $.ajax({
                    url: "/api/v1/ytdownload",
                    type: 'POST',
                    cache: false,
                    data: { url: url, socketid: socketid },
                    success: function (data) {
                        console.log('Success!')
                    }
                    , error: function (jqXHR, textStatus, err) {
                        console.log('err status ' + textStatus + ', err ' + err)
                    }
                })
            // }
        });
    </script>
</body>

</html>